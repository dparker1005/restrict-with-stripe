(()=>{"use strict";const t=window.wp.element;!function(e){const{__}=e.i18n,{registerPlugin:r}=e.plugins,{PluginDocumentSettingPanel:i}=e.editPost,{Component:s}=e.element,{Spinner:n,CheckboxControl:c}=e.components,{withSelect:a,withDispatch:o}=e.data,{compose:l}=e.compose,d=l(o((function(t,e){return{setMetaValue:function(r){t("core/editor").editPost({meta:{[e.metaKey]:r}})}}})),a((function(t,e){return{metaValue:t("core/editor").getEditedPostAttribute("meta")[e.metaKey]}})))((function(e){const r=e.products.map((r=>(0,t.createElement)(c,{key:r.id,label:r.name+(r.default_price?"":" ("+__("no default price set","restrict-with-stripe")+")"),checked:e.metaValue.includes(r.id),onChange:()=>{let t=[...e.metaValue];t.includes(r.id)?t=t.filter((t=>t!==r.id)):t.push(r.id),e.setMetaValue(t)}})));return(0,t.createElement)("fragment",null,(0,t.createElement)("h3",null,__("Select products to restrict by","restrict-with-stripe")),r.length>6?(0,t.createElement)("div",{className:"rwstripe-scrollable-div"},r):r)}));r("rwstripe-sidebar",{icon:"lock",render:class extends s{constructor(t){super(t),this.state={productList:[],loadingProducts:!0}}componentDidMount(){this.fetchProducts()}fetchProducts(){e.apiFetch({path:"rwstripe/v1/products"}).then((t=>{this.setState({productList:t,loadingProducts:!1})})).catch((t=>{this.setState({productList:t.message,loadingProducts:!1})}))}render(){var e=(0,t.createElement)(n,null);return this.state.loadingProducts||(e=Array.isArray(this.state.productList)&&void 0!==rwstripeSidebar.restricted_product_ids_meta_key?0===this.state.productList.length?(0,t.createElement)("div",null,(0,t.createElement)("p",null,__("No products found. Please create a product in Stripe.","restrict-with-stripe")),(0,t.createElement)("p",null,(0,t.createElement)("a",{href:rwstripeSidebar.stripe_products_url,target:"_blank"},__("Manage Products in Stripe","restrict-with-stripe")))):(0,t.createElement)("div",null,(0,t.createElement)(d,{label:__("Stripe Product","restrict-with-stripe"),metaKey:rwstripeSidebar.restricted_product_ids_meta_key,products:this.state.productList}),(0,t.createElement)("p",null,(0,t.createElement)("a",{href:rwstripeSidebar.stripe_products_url,target:"_blank"},__("Manage Products in Stripe","restrict-with-stripe")))):(0,t.createElement)("p",null,__("Could not connect to Stripe. Please check your Stripe connection on the Restrict With Stripe settings page.","restrict-with-stripe"))),(0,t.createElement)(i,{name:"rwstripe-sidebar-panel",title:__("Restrict With Stripe","restrict-with-stripe")},e)}}})}(window.wp)})();