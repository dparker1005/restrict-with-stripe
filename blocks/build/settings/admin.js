(()=>{"use strict";var e,t={815:(e,t,r)=>{const i=window.wp.element,s=window.wp.apiFetch;var n=r.n(s);const c=r.p+"images/restrict-with-stripe.f445c776.png",a=window.wp.components,l=window.wp.data,o=window.wp.i18n,p=window.wp.notices,_=()=>{const e=(0,l.useSelect)((e=>e(p.store).getNotices().filter((e=>"snackbar"===e.type))),[]),{removeNotice:t}=(0,l.useDispatch)(p.store);return(0,i.createElement)(a.SnackbarList,{className:"edit-site-notices",notices:e,onRemove:t})};class m extends i.Component{constructor(){super(...arguments),this.state={rwstripe_show_excerpts:!0,rwstripe_collect_password:!0,isAPILoaded:!1,productList:[],areProductsLoaded:!1}}componentDidMount(){n()({path:"/wp/v2/settings"}).then((e=>{console.log(e),e.hasOwnProperty("rwstripe_show_excerpts")&&this.setState({rwstripe_show_excerpts:e.rwstripe_show_excerpts,rwstripe_collect_password:e.rwstripe_collect_password,isAPILoaded:!0})})),wp.apiFetch({path:"rwstripe/v1/products"}).then((e=>{this.setState({productList:e,areProductsLoaded:!0})})).catch((e=>{this.setState({areProductsLoaded:e.message})}))}render(){const{rwstripe_show_excerpts:e,rwstripe_collect_password:t,isAPILoaded:r,productList:s,areProductsLoaded:p}=this.state;if(!r||!p)return(0,i.createElement)(a.Placeholder,null,(0,i.createElement)(a.Spinner,null));var m;if(rwstripe.stripe_account_id)if(!0===p){var h=(0,o.__)("Connect to Stripe (Connected)","restrict-with-stripe");"live"!==rwstripe.stripe_environment&&(h=(0,o.__)("Connect to Stripe (Connected in Test Mode)","restrict-with-stripe")),m=(0,i.createElement)(a.PanelBody,{title:h,initialOpen:!1},(0,i.createElement)("p",null,(0,o.__)("Connected to account: %d.","restrict-with-stripe").replace("%d",rwstripe.stripe_account_id)),(0,i.createElement)("p",null,(0,i.createElement)("a",{href:rwstripe.stripe_dashboard_url,target:"_blank"},(0,o.__)("Visit your Stripe account dashboard","restrict-with-stripe"))),(0,i.createElement)("a",{href:rwstripe.stripe_connect_url,class:"rwstripe-stripe-connect"},(0,i.createElement)("span",null,(0,o.__)("Disconnect From Stripe","restrict-with-stripe"))))}else h=(0,o.__)("Connect to Stripe (Error)","restrict-with-stripe"),"live"!==rwstripe.stripe_environment&&(h=(0,o.__)("Connect to Stripe (Error in Test Mode)","restrict-with-stripe")),m=(0,i.createElement)(a.PanelBody,{title:h},(0,i.createElement)("p",null,(0,o.__)("The following error is received when trying to communicate with Stripe:","restrict-with-stripe")),(0,i.createElement)("p",null,p),(0,i.createElement)("a",{href:rwstripe.stripe_connect_url,class:"rwstripe-stripe-connect"},(0,i.createElement)("span",null,(0,o.__)("Disconnect From Stripe","restrict-with-stripe"))));else{var d=(0,o.__)("Connect to Stripe","restrict-with-stripe");rwstripe.connect_in_test_mode&&(d+=" ("+(0,o.__)("Test Mode","restrict-with-stripe")+")"),m=(0,i.createElement)(a.PanelBody,{title:(0,o.__)("Connect to Stripe","restrict-with-stripe")},(0,i.createElement)("a",{href:rwstripe.stripe_connect_url,class:"rwstripe-stripe-connect"},(0,i.createElement)("span",null,d)))}return(0,i.createElement)(i.Fragment,null,(0,i.createElement)("div",{className:"rwstripe-settings__header"},(0,i.createElement)("div",{className:"rwstripe-settings__container"},(0,i.createElement)("div",{className:"rwstripe-settings__title"},(0,i.createElement)("img",{src:c,alt:"{__('Restrict with Stripe', 'restrict-with-stripe')}"})))),(0,i.createElement)("div",{className:"rwstripe-settings__main"},m,(0,i.createElement)(a.PanelBody,{title:(0,o.__)("Create Products in Stripe","restrict-with-stripe"),initialOpen:rwstripe.stripe_account_id&&!s.length},(0,i.createElement)("p",null,(0,o.__)("Restrict with Stripe uses Stripe Products to track user access to site content.","restrict-with-stripe")),(0,i.createElement)("p",null,(0,o.__)("Create a unique Stripe Product for each piece of content you need to restrict, whether it be a single post or page, a category of posts, or something else.","restrict-with-stripe")),s.length>0?(0,i.createElement)("fragment",null,(0,i.createElement)("a",{href:rwstripe.stripe_dashboard_url+"products/?active=true",target:"_blank"},(0,i.createElement)(a.Button,{isPrimary:!0,isLarge:!0},(0,o.__)("Manage %d Products","restrict-with-stripe").replace("%d",s.length)))):(0,i.createElement)("fragment",null,(0,i.createElement)("a",{href:rwstripe.stripe_dashboard_url+"products/create",target:"_blank"},(0,i.createElement)(a.Button,{isPrimary:!0,isLarge:!0},(0,o.__)("Create a New Product","restrict-with-stripe"))))),(0,i.createElement)(a.PanelBody,{title:(0,o.__)("Restrict Site Content","restrict-with-stripe"),initialOpen:rwstripe.stripe_account_id},(0,i.createElement)("p",null,(0,o.__)("Restrict a single piece of content or protect a group of posts by category or tag.","restrict-with-stripe")),(0,i.createElement)("div",{className:"columns"},(0,i.createElement)("div",{className:"column"},(0,i.createElement)("h3",null,(0,o.__)("For Posts and Pages","restrict-with-stripe","restrict-with-stripe")),(0,i.createElement)("ol",null,(0,i.createElement)("li",null,(0,o.__)("Edit the post or page","restrict-with-stripe")),(0,i.createElement)("li",null,(0,o.__)("Open the Settings panel","restrict-with-stripe")),(0,i.createElement)("li",null,(0,o.__)('Select Stripe Products in the "Restrict with Stripe" panel',"restrict-with-stripe")),(0,i.createElement)("li",null,(0,o.__)("Save changes","restrict-with-stripe"))),(0,i.createElement)("a",{href:rwstripe.admin_url+"edit.php?post_type=post"},(0,i.createElement)(a.Button,{isSecondary:!0},(0,o.__)("View Posts","restrict-with-stripe"))),"  ",(0,i.createElement)("a",{href:rwstripe.admin_url+"edit.php?post_type=page"},(0,i.createElement)(a.Button,{isSecondary:!0},(0,o.__)("View Pages","restrict-with-stripe")))),(0,i.createElement)("div",{className:"column"},"gif here")),(0,i.createElement)("div",{className:"columns"},(0,i.createElement)("div",{className:"column"},(0,i.createElement)("h3",null,(0,o.__)("For Categories and Tags","restrict-with-stripe","restrict-with-stripe")),(0,i.createElement)("ol",null,(0,i.createElement)("li",null,(0,o.__)("Edit the category or tag","restrict-with-stripe")),(0,i.createElement)("li",null,(0,o.__)("Select Stripe Products","restrict-with-stripe")),(0,i.createElement)("li",null,(0,o.__)("Save changes","restrict-with-stripe"))),(0,i.createElement)("a",{href:rwstripe.admin_url+"edit-tags.php?taxonomy=category"},(0,i.createElement)(a.Button,{isSecondary:!0},(0,o.__)("View Categories","restrict-with-stripe"))),"  ",(0,i.createElement)("a",{href:rwstripe.admin_url+"edit-tags.php?taxonomy=post_tag"},(0,i.createElement)(a.Button,{isSecondary:!0},(0,o.__)("View Tags","restrict-with-stripe")))),(0,i.createElement)("div",{className:"column"},"gif here"))),(0,i.createElement)(a.PanelBody,{title:(0,o.__)("Link to Stripe Customer Portal","restrict-with-stripe"),initialOpen:rwstripe.stripe_account_id},(0,i.createElement)("p",null,(0,o.__)("The Customer Portal is a Stripe tool that allows customers to view previous payments and manage active subscriptions. Give customers a link to the portal using one of the methods below:","restrict-with-stripe")),(0,i.createElement)("div",{className:"columns"},(0,i.createElement)("div",{className:"column"},(0,i.createElement)("h3",null,(0,o.__)('Create a "Customer Portal" Menu Item',"restrict-with-stripe","restrict-with-stripe")),(0,i.createElement)("ol",null,(0,i.createElement)("li",null,(0,o.__)("Edit the desired menu","restrict-with-stripe")),(0,i.createElement)("li",null,(0,o.__)('In the "Restrict with Stripe" panel, select the "Stripe Customer Portal" menu item and click "Add to Menu"',"restrict-with-stripe")),(0,i.createElement)("li",null,(0,o.__)('Click "Save Menu"',"restrict-with-stripe")))),(0,i.createElement)("div",{className:"column"},"gif here")),(0,i.createElement)("div",{className:"columns"},(0,i.createElement)("div",{className:"column"},(0,i.createElement)("h3",null,(0,o.__)('Use the "Stripe Customer Portal" Block',"restrict-with-stripe","restrict-with-stripe")),(0,i.createElement)("ol",null,(0,i.createElement)("li",null,(0,o.__)("Edit the desired page","restrict-with-stripe")),(0,i.createElement)("li",null,(0,o.__)('Insert the "Stripe Customer Portal" block',"restrict-with-stripe")),(0,i.createElement)("li",null,(0,o.__)("Save changes","restrict-with-stripe")))),(0,i.createElement)("div",{className:"column"},"gif here"))),(0,i.createElement)(a.PanelBody,{title:(0,o.__)("Customize Advanced Settings","restrict-with-stripe"),initialOpen:rwstripe.stripe_account_id},(0,i.createElement)("p",null,(0,o.__)("Confirm advanced settings for default behavior (optional).","restrict-with-stripe")),(0,i.createElement)(a.ToggleControl,{label:(0,o.__)("Show a content excerpt on restricted posts or pages","restrict-with-stripe"),onChange:e=>this.setState({rwstripe_show_excerpts:e}),checked:e}),(0,i.createElement)(a.ToggleControl,{label:(0,o.__)("Allow customers to choose a password during registration","restrict-with-stripe"),onChange:e=>this.setState({rwstripe_collect_password:e}),checked:t}),(0,i.createElement)("p",null,(0,i.createElement)(a.Button,{isPrimary:!0,onClick:()=>{const{rwstripe_show_excerpts:e,rwstripe_collect_password:t}=this.state;n()({path:"/wp/v2/settings",method:"POST",data:{rwstripe_show_excerpts:e,rwstripe_collect_password:t}}).then((e=>{(0,l.dispatch)("core/notices").createNotice("success",(0,o.__)("Settings Saved","restrict-with-stripe"),{type:"snackbar",isDismissible:!0})}),(e=>{(0,l.dispatch)("core/notices").createNotice("error",(0,o.__)("Save Failed","restrict-with-stripe"),{type:"snackbar",isDismissible:!0})}))}},(0,o.__)("Save","restrict-with-stripe"))))),(0,i.createElement)("div",{className:"rwstripe-settings__notices"},(0,i.createElement)(_,null)))}}document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("rwstripe-settings");e&&(0,i.render)((0,i.createElement)(m,null),e)}))}},r={};function i(e){var s=r[e];if(void 0!==s)return s.exports;var n=r[e]={exports:{}};return t[e](n,n.exports,i),n.exports}i.m=t,e=[],i.O=(t,r,s,n)=>{if(!r){var c=1/0;for(p=0;p<e.length;p++){for(var[r,s,n]=e[p],a=!0,l=0;l<r.length;l++)(!1&n||c>=n)&&Object.keys(i.O).every((e=>i.O[e](r[l])))?r.splice(l--,1):(a=!1,n<c&&(c=n));if(a){e.splice(p--,1);var o=s();void 0!==o&&(t=o)}}return t}n=n||0;for(var p=e.length;p>0&&e[p-1][2]>n;p--)e[p]=e[p-1];e[p]=[r,s,n]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e+"../"})(),(()=>{var e={412:0,785:0};i.O.j=t=>0===e[t];var t=(t,r)=>{var s,n,[c,a,l]=r,o=0;if(c.some((t=>0!==e[t]))){for(s in a)i.o(a,s)&&(i.m[s]=a[s]);if(l)var p=l(i)}for(t&&t(r);o<c.length;o++)n=c[o],i.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return i.O(p)},r=globalThis.webpackChunkrestrict_with_stripe=globalThis.webpackChunkrestrict_with_stripe||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var s=i.O(void 0,[785],(()=>i(815)));s=i.O(s)})();